(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{203:function(e,t,a){},204:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(69),i=a.n(c),r=a(11),l=a(12),o=a(9),d=a(14),h=a(13),j=a(18),u=a(19),b=a.n(u),O=a(230),p=a(1),m=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Whoops! This email is taken.",content:"Use another email."})},x=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Unable to delete account, something went wrong please try again."})},f=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Unable to change email, something went wrong, please try again."})},g=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Unable to change password, something went wrong, please try again."})},C=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Incorrect email or password.",content:"Try, again."})},v=function(){return Object(p.jsx)(O.a,{negative:!0,header:"New password and confirm password don't match",content:"Try again"})},w=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Old password is incorrect",content:"Try again"})},k=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Emails don't match",content:"Try again"})},S=function(){return Object(p.jsx)(O.a,{negative:!0,header:"Email already exists",content:"try different email"})},y=function(){return Object(p.jsx)(O.a,{negative:!0,header:"something went wrong with the update, please try again"})},_=a(231),E=a(224),D=a(205),M=new(function(){function e(){Object(r.a)(this,e),this.authenticated=!1,this.user=null,this.user_id=null,this.token=null}return Object(l.a)(e,[{key:"login",value:function(e,t,a,n){this.authenticated=!0,this.token=t,this.user=e,this.user_id=a,n()}},{key:"logout",value:function(e){var t=this;this.authenticated=!1,b.a.post("/logout",this.user,{withCredentials:!0}).then((function(a){t.user=null,t.token=null,e()})).catch((function(e){return e}))}},{key:"isAuth",value:function(){return this.authenticated}},{key:"getUser",value:function(){return this.user}},{key:"setToken",value:function(e){this.token=e}},{key:"setUser",value:function(e){this.user=e}}]),e}()),I=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onChangeEmail=function(e){n.setState({email:e.target.value})},n.onChangePassword=function(e){n.setState({password:e.target.value})},n.getSubmit=function(e){e.preventDefault();var t={email:n.state.email,password:n.state.password};b.a.post("/login",t,{withCredentials:!0}).then((function(e){"mismatch"===e.data.authentication||"no-match"===e.data.authentication?n.setState({loggedIn:!1}):M.login(e.data.user,e.data.token,e.data.uid,(function(){n.props.history.push("/upload")}))})).catch((function(e){n.props.history.push("/")}))},n.onChangeEmail=n.onChangeEmail.bind(Object(o.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(o.a)(n)),n.getSubmit=n.getSubmit.bind(Object(o.a)(n)),n.state={email:"",password:"",loggedIn:null},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsxs)(_.a,{children:[!1===this.state.loggedIn?Object(p.jsx)(C,{}):null,Object(p.jsx)(E.a,{onSubmit:this.getSubmit,children:Object(p.jsxs)(_.a,{basic:!0,children:[Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"Email"}),Object(p.jsx)("input",{onChange:this.onChangeEmail,value:this.state.email,type:"email",id:"email",name:"email"})]}),Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"Password"}),Object(p.jsx)("input",{type:"password",id:"password",name:"password",value:this.state.password,onChange:this.onChangePassword})]}),Object(p.jsx)(D.a,{type:"submit",primary:!0,children:"Submit"})]})})]})}}]),a}(s.a.Component),P=Object(j.g)(I),A=a(220),R=a(234),F=a(221),U=a(235),H=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).toReg=function(){n.props.history.push("/register")},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsxs)(A.a,{fluid:!0,children:[Object(p.jsxs)(A.a,{textAlign:"center",children:[Object(p.jsx)(R.a,{as:"h1",children:"Receipt Tracker"}),Object(p.jsx)(F.a,{})]}),Object(p.jsx)(A.a,{children:Object(p.jsxs)(_.a,{placeholder:!0,children:[Object(p.jsxs)(U.a,{columns:2,relaxed:"very",stackable:!0,children:[Object(p.jsx)(U.a.Column,{children:Object(p.jsx)(P,{})}),Object(p.jsx)(U.a.Column,{verticalAlign:"middle",children:Object(p.jsxs)(_.a,{children:["Don't have an account?",Object(p.jsx)(D.a,{primary:!0,onClick:this.toReg,children:Object(p.jsx)(D.a.Content,{children:"Register"})})]})})]}),Object(p.jsx)(F.a,{vertical:!0})]})})]})}}]),a}(s.a.Component),L=Object(j.g)(H),T=a(16),V=a(35),N=Object(j.g)((function(e){return Object(p.jsxs)("div",{class:"ui four item menu",children:[Object(p.jsx)(V.b,{class:"item",to:"/account",children:"Account"}),Object(p.jsx)(V.b,{class:"item",to:"/upload",children:"Upload"}),Object(p.jsx)(V.b,{class:"item",to:"/receipts",children:"Receipts"}),Object(p.jsx)(V.b,{class:"item",onClick:function(){M.logout((function(){return e.history.push("/")}))},children:"Log Out"})]})})),B=a(53),z=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onChangeFile=function(e){n.setState({fileChosen:e.target.files[0]})},n.onChangeLoader=function(e){n.setState({loading:e})},n.onDataProcessed=function(e){return clearInterval(n.state.intervalId),n.props.handleData(e)},n.onSubmitFile=function(e){e.preventDefault();var t=new FormData;t.append("avatar",n.state.fileChosen);var a={headers:{"content-type":"multipart/form-data"},Authorization:n.props.token,withCredentials:!0};n.onChangeLoader(!0),b.a.post("/users/".concat(n.user_id,"/uploads"),t,a).then((function(e){console.log("res from upload",e),n.setState({job:{id:e.data.data.id}}),n.setState({intervalId:setInterval(n.checkProgress,1500)})})).catch((function(e){return n.props.handleCompletion("INCOMPLETE")}))},n.checkProgress=function(){var e={Authorization:n.props.token,withCredentials:!0};b.a.get("/users/".concat(n.user_id,"/uploads/").concat(n.state.job.id),e).then((function(e){console.log("checking progress",e.data),"completed"===e.data.jobState?(n.onChangeLoader(!1),n.onDataProcessed(e.data.data.data)):"failed"===e.data.jobState&&(clearInterval(n.state.intervalId),n.props.handleCompletion("INCOMPLETE"))})).catch((function(e){return clearInterval(n.state.intervalId),n.props.handleCompletion("INCOMPLETE")}))},n.selectFile=function(e){n.setState({fileName:""}),e.target.nextSibling.click()},n.onChangeFile=n.onChangeFile.bind(Object(o.a)(n)),n.onSubmitFile=n.onSubmitFile.bind(Object(o.a)(n)),n.onChangeLoader=n.onChangeLoader.bind(Object(o.a)(n)),n.onDataProcessed=n.onDataProcessed.bind(Object(o.a)(n)),n.checkProgress=n.checkProgress.bind(Object(o.a)(n)),n.state={fileChosen:null,intervalId:null,loading:!1,job:{id:null,status:null},cell:{row:"",name:""},fileName:null},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsx)(A.a,{textAlign:"center",children:Object(p.jsxs)(_.a,{basic:!0,children:[Object(p.jsx)(R.a,{icon:!0,children:Object(p.jsx)(B.a,{name:"file image outline"})}),Object(p.jsxs)(E.a,{id:"upload-form",loading:this.state.loading,children:[Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:this.state.fileChosen?this.state.fileChosen.name:null}),Object(p.jsx)(D.a,{onClick:this.selectFile,children:"Select File"}),Object(p.jsx)("input",{id:"fileUpload",onChange:this.onChangeFile,type:"file",name:"receipt",accept:".png, .jpg, .jpeg",hidden:!0})]}),Object(p.jsx)(D.a,{size:"medium",color:"blue",type:"submit",onClick:this.onSubmitFile,children:"Upload"})]})]})})}}]),a}(s.a.Component),K=a(226),q=a(219),J=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onChangeCell=function(e){var t=e.target.closest("tr").getAttribute("id"),a=e.target.getAttribute("id");if(null==a)return!1;n.setState((function(e){return Object(T.a)(Object(T.a)({},e),{},{cell:{row:t,name:a}})}))},n.onDelete=function(e){var t=e.target.closest("tr").id,a=Object(T.a)({},n.props.data).items;delete a[t],n.props.handleData({items:a})},n.saveReceipt=function(){n.setState({loading:!0});var e=n.props.data;b.a.post("/users/".concat(n.user_id,"/receipts"),e,{withCredentials:!0}).then((function(e){n.setState({loading:!1},(function(){n.props.setComplete(!1)}))})).catch((function(e){console.log(e),n.props.setComplete(!0)}))},n.handleEnter=function(e){"Enter"===e.code&&n.setState({cell:{row:"",name:""}})},n.otherChange=function(e){var t=e.target.value,a=e.target.id,s=Object(T.a)({},n.props.data),c=s.store,i=s.date;"store"===a?c=t:i=t,n.props.handleData({store:c,date:i})},n.valueChange=function(e){var t=e.target.defaultValue,a=e.target.id,s=e.target.closest("tr").id,c=Object(T.a)({},n.props.data).items;for(var i in c)c[i].item_name===t&&"item"===a&&s==i&&(c[i].item_name=e.target.value),c[i].price===t&&"price"===a&&s==i&&(c[i].price=e.target.value);n.props.handleData({items:c})},n.valueChange=n.valueChange.bind(Object(o.a)(n)),n.onChangeCell=n.onChangeCell.bind(Object(o.a)(n)),n.onDelete=n.onDelete.bind(Object(o.a)(n)),n.saveReceipt=n.saveReceipt.bind(Object(o.a)(n)),n.handleEnter=n.handleEnter.bind(Object(o.a)(n)),n.state={cell:{row:"",name:""},loading:!1},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;if(null==this.props.data)return Object(p.jsx)("div",{});var t=this.props.data.date,a=this.props.data.store,n=this.props.data.items;return Object(p.jsxs)("div",{children:[Object(p.jsx)(D.a,{floated:"right",color:"green",onClick:this.saveReceipt,basic:!0,loading:this.state.loading,children:"Save Receipt"}),Object(p.jsxs)(K.a,{onKeyDown:this.handleEnter,children:[Object(p.jsxs)(K.a.Header,{children:[Object(p.jsxs)(K.a.Row,{children:[Object(p.jsx)(K.a.HeaderCell,{children:"Date"}),Object(p.jsx)(K.a.HeaderCell,{children:"Store"}),Object(p.jsx)(K.a.HeaderCell,{})]}),Object(p.jsxs)(K.a.Row,{onClick:this.onChangeCell,id:"initial",children:["date"==this.state.cell.name?Object(p.jsx)(K.a.Cell,{children:Object(p.jsx)(q.a,{defaultValue:t,id:"date",onChange:this.otherChange})}):Object(p.jsx)(K.a.Cell,{value:t,id:"date",children:t}),"store"==this.state.cell.name?Object(p.jsx)(K.a.Cell,{children:Object(p.jsx)(q.a,{defaultValue:a,id:"store",onChange:this.otherChange})}):Object(p.jsx)(K.a.Cell,{value:a,id:"store",children:a})]}),Object(p.jsxs)(K.a.Row,{children:[Object(p.jsx)(K.a.HeaderCell,{children:"Item"}),Object(p.jsx)(K.a.HeaderCell,{children:"Price"}),Object(p.jsx)(K.a.HeaderCell,{})]})]}),Object(p.jsx)(K.a.Body,{children:Object.keys(n).map((function(t){var a=n[t].item_name,s=n[t].price;return Object(p.jsxs)(K.a.Row,{onClick:e.onChangeCell,id:t,children:[e.state.cell.row==t&&"item"==e.state.cell.name?Object(p.jsx)(K.a.Cell,{children:Object(p.jsx)(q.a,{defaultValue:a,id:"item",onChange:e.valueChange})}):Object(p.jsx)(K.a.Cell,{value:a,name:a,id:"item",children:a}),e.state.cell.row==t&&"price"==e.state.cell.name?Object(p.jsx)(K.a.Cell,{children:Object(p.jsx)(q.a,{defaultValue:s,id:"price",onChange:e.valueChange})}):Object(p.jsx)(K.a.Cell,{value:s,name:s,id:"price",children:s}),Object(p.jsx)(K.a.Cell,{children:Object(p.jsx)(D.a,{floated:"right",color:"red",onClick:e.onDelete,children:"Delete Item"})})]},t)}))})]})]})}}]),a}(s.a.Component),W=function(e){var t=e.completion;return"COMPLETED"===t?Object(p.jsx)(O.a,{success:!0,header:"receipt uploaded successfully",content:"viewable in receipts"}):"INCOMPLETE"===t?Object(p.jsx)(O.a,{negative:!0,header:"something went wrong try again."}):null},Y=a(223),G=a(137),Q=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleData=function(e){var t=e.email,a=e.items,s=e.store,c=e.date;n.setState((function(e){return Object(T.a)(Object(T.a)({},e),{},{data:{email:t||e.data.email,items:a||e.data.items,store:s||e.data.store,date:c||e.data.date},exists:!0})}))},n.handleCompletion=function(e){if(e)return n.setState({completion:"INCOMPLETE"});n.setState({completion:"COMPLETED"})},n.handleData=n.handleData.bind(Object(o.a)(n)),n.handleCompletion=n.handleCompletion.bind(Object(o.a)(n)),n.state={data:{email:"",items:{},store:"",date:""},exists:null,completion:""},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsxs)("div",{class:"ui container",children:[Object(p.jsx)(N,{}),Object(p.jsx)(W,{completion:this.state.completion}),Object(p.jsx)("h1",{children:" Upload Receipt "}),Object(p.jsx)(A.a,{textAlign:"right",children:Object(p.jsx)(Y.a,{trigger:Object(p.jsx)(D.a,{icon:"question"}),children:Object(p.jsx)(G.a,{children:Object(p.jsxs)(_.a,{basic:!0,padded:!0,children:["+ click cell to edit data ",Object(p.jsx)("br",{}),"+ save data"]})})})}),Object(p.jsx)(_.a,{children:Object(p.jsx)(z,{handleData:this.handleData,handleCompletion:this.handleCompletion})}),Object(p.jsx)(_.a,{padded:"very",children:this.state.exists?Object(p.jsx)(J,{handleData:this.handleData,data:this.state.data,setComplete:this.handleCompletion}):null})]})}}]),a}(s.a.Component),X=a(227),Z=a(229),$=function(e){var t=e.store,a=e.date,n=e.handleDelete,s=e.operateModal,c=e.loading,i=e.handleEdit;return Object(p.jsx)(_.a,{basic:!0,children:Object(p.jsxs)(Z.a,{children:[Object(p.jsxs)(Z.a.Content,{children:[Object(p.jsx)(Z.a.Header,{children:t}),Object(p.jsx)(Z.a.Meta,{children:a})]}),Object(p.jsx)(Z.a.Content,{extra:!0,children:Object(p.jsxs)("div",{class:"ui three buttons",children:[Object(p.jsx)(D.a,{id:"view",onClick:s,color:"green",children:"View"}),Object(p.jsx)(D.a,{id:"edit",color:"black",onClick:i,children:"Edit"}),Object(p.jsx)(D.a,{id:"delete",onClick:n,color:"red",loading:c,children:"Delete"})]})})]})})},ee=a(232),te=a(222),ae=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).cellClicked=function(e){var t=e.target.closest("tr").id,a=e.target.id;n.setState({key:t,clicked_id:a})},n.inputChange=function(e){var t=e.target.value,a=n.state.key,s=e.target.id;n.setState((function(e){return"store"===s?e.store=t:"date"===s?e.date=t:e.items[a][s]=t,e}))},n.handleEnter=function(e){"Enter"===e.code&&n.setState({clicked_id:""})},n.handleItemDelete=function(e){var t=e.target.closest("tr").id;n.setState((function(e){return delete e.items[t],e}))},n.submitChange=function(){n.setState({dimmer:!0,loader:!0});var e=n.state.store,t=n.state.date,a=n.props.data.receipt_id,s=Object.keys(n.state.items).map((function(e){var t=n.state.items;return[t[e].item_name,t[e].item_price,n.props.data.receipt_id]}));b.a.put("/users/".concat(n.user_id,"/receipts/").concat(a),{store:e,date:t,items:s,receipt_id:a},{withCredentials:!0}).then((function(e){return n.setState({dimmer:!1,loader:!1},(function(){n.props.setMessage("success"),n.props.operateModal()})),n.props.getAll()})).catch((function(e){return n.setState({dimmer:!1,loader:!1},(function(){n.props.setMessage("error")}))}))},n.state={items:n.props.data.items,store:n.props.data.store,date:n.props.data.receipt_date,key:"",clicked_id:"",dimmer:!1,loader:!1},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.key+this.state.clicked_id;return Object(p.jsxs)(A.a,{children:[Object(p.jsx)(ee.a,{active:this.state.dimmer,children:Object(p.jsx)(te.a,{active:this.state.loader})}),Object(p.jsxs)(K.a,{onKeyDown:this.handleEnter,attached:"top",children:[Object(p.jsx)(K.a.Header,{children:Object(p.jsxs)(K.a.Row,{children:[Object(p.jsx)(K.a.HeaderCell,{children:"Store"}),Object(p.jsx)(K.a.HeaderCell,{children:"Date"})]})}),Object(p.jsx)(K.a.Body,{children:Object(p.jsxs)(K.a.Row,{id:"header",children:[Object(p.jsx)(K.a.Cell,{id:"store",onClick:this.cellClicked,children:"store"===this.state.clicked_id?Object(p.jsx)(q.a,{id:"store",defaultValue:this.state.store,onChange:this.inputChange}):this.state.store}),Object(p.jsx)(K.a.Cell,{id:"date",onClick:this.cellClicked,children:"date"===this.state.clicked_id?Object(p.jsx)(q.a,{id:"date",defaultValue:this.state.date,onChange:this.inputChange}):this.state.date})]})})]}),Object(p.jsxs)(K.a,{onKeyDown:this.handleEnter,attached:"bottom",children:[Object(p.jsx)(K.a.Header,{children:Object(p.jsxs)(K.a.Row,{children:[Object(p.jsx)(K.a.HeaderCell,{children:"Item"}),Object(p.jsx)(K.a.HeaderCell,{children:"Price"}),Object(p.jsx)(K.a.HeaderCell,{})]})}),Object(p.jsx)(K.a.Body,{children:Object.keys(this.state.items).map((function(a){var n=e.state.items[a].item_name,s=e.state.items[a].item_price;return Object(p.jsxs)(K.a.Row,{id:a,children:[t===a+"item_name"?Object(p.jsx)(q.a,{id:"item_name",onChange:e.inputChange,defaultValue:n}):Object(p.jsx)(K.a.Cell,{id:"item_name",onClick:e.cellClicked,children:n}),t===a+"item_price"?Object(p.jsx)(q.a,{id:"item_price",onChange:e.inputChange,defaultValue:s}):Object(p.jsx)(K.a.Cell,{id:"item_price",onClick:e.cellClicked,children:s}),Object(p.jsx)(K.a.Cell,{children:Object(p.jsx)(D.a,{size:"small",onClick:e.handleItemDelete,color:"red",children:"Delete Item"})})]},a)}))})]}),Object(p.jsx)(D.a,{floated:"right",onClick:this.submitChange,color:"green",children:"Submit Changes"})]})}}]),a}(s.a.Component),ne=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleDelete=function(e){var t=n.state.data.receipt_id;console.log("rid",t),n.setState({deleteLoading:!0});b.a.delete("/users/".concat(n.user_id,"/receipts/").concat(t),{headers:{withCredentials:!0}}).then((function(e){return n.setState({deleteLoading:!1}),n.props.getAll()})).catch((function(e){return console.log(e)}))},n.operateModal=function(){n.setState((function(e){return Object(T.a)(Object(T.a)({},e),{},{showModal:!e.showModal})}),(function(){!0===n.state.showModal&&n.props.modalOn===n.state.data.receipt_id&&n.props.clearModal("")}))},n.handleEdit=function(){n.setState({edit_table:!0})},n.handleDelete=n.handleDelete.bind(Object(o.a)(n)),n.operateModal=n.operateModal.bind(Object(o.a)(n)),n.handleEdit=n.handleEdit.bind(Object(o.a)(n)),n.state={data:n.props.data,deleteLoading:!1,showModal:!1,edit_table:!1},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.modalOn===this.state.data.receipt_id&&this.setState({showModal:!0})}},{key:"componentDidUpdate",value:function(e){if(this.props.modalOn!==e.modalOn&&this.props.modalOn===this.state.data.receipt_id)return this.setState({showModal:!0})}},{key:"render",value:function(){var e=this,t=this.props.data.store,a=this.props.data.receipt_date;return Object(p.jsxs)("div",{children:[Object(p.jsx)($,{store:t,date:a,handleDelete:this.handleDelete,handleEdit:this.handleEdit,operateModal:this.operateModal,loading:this.state.deleteLoading}),Object(p.jsx)(X.a,{onClose:function(){e.setState({edit_table:!1})},open:this.state.edit_table,children:Object(p.jsx)(ae,{data:this.props.data,setMessage:this.props.setMessage,operateModal:function(){return e.setState({edit_table:!1})},getAll:this.props.getAll})}),Object(p.jsx)(X.a,{onClose:this.operateModal,onOpen:this.operateModal,open:this.state.showModal,children:Object(p.jsx)(A.a,{children:Object(p.jsxs)(K.a,{fixed:!0,basic:!0,children:[Object(p.jsx)(K.a.Header,{children:Object(p.jsxs)(K.a.Row,{children:[Object(p.jsx)(K.a.HeaderCell,{children:"Item"}),Object(p.jsx)(K.a.HeaderCell,{children:"Price"})]})}),Object(p.jsx)(K.a.Body,{children:Object.keys(this.props.data.items).map((function(t){return Object(p.jsxs)(K.a.Row,{id:"item",children:[Object(p.jsx)(K.a.Cell,{id:"item_name",children:e.props.data.items[t].item_name}),Object(p.jsx)(K.a.Cell,{id:"price",children:e.props.data.items[t].item_price})]},t)}))})]})})})]})}}]),a}(s.a.Component),se=a(225),ce=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleSearchChange=function(e){var t=e.target.value,a={params:{search:!0,value:t}};t.length>0&&(n.setState({loading:!0}),b.a.get("/users/".concat(n.user_id,"/receipts"),a,{withCredentials:!0}).then((function(e){var t=e.data.data.rows.map((function(e){return Object(T.a)(Object(T.a)({},e),{},{key:e.price})}));n.setState({results:t,loading:!1})})).catch((function(e){console.log(e)})))},n.handleSearchChange=n.handleSearchChange.bind(Object(o.a)(n)),n.state={results:[],loading:!1},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(p.jsx)(se.a,{loading:this.state.loading,onResultSelect:function(t,a){return e.props.setModal(a.result.price)},onSearchChange:this.handleSearchChange,results:this.state.results})}}]),a}(s.a.Component),ie=function(){return Object(p.jsx)(O.a,{success:!0,header:"Password changed successfully"})},re=function(){return Object(p.jsx)(O.a,{success:!0,header:"Email changed successfully"})},le=function(){return Object(p.jsx)(O.a,{success:!0,header:"Receipt updated successfully"})},oe=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).getAll=function(e){var t;t=e?{params:{specific:e}}:{params:{quantity:10}},b.a.get("/users/".concat(n.user_id,"/receipts"),t,{withCredentials:!0}).then((function(t){var a=t.data.data;return console.log(a),n.createDataObject(a,e)})).catch((function(e){return n.setState({success:!1})}))},n.createDataObject=function(e,t){var a={};Object.keys(e).forEach((function(t){var n=e[t].receipt_id;n in a||(a[n]={store:e[t].store,receipt_date:e[t].receipt_date.split("T")[0],receipt_id:e[t].receipt_id,items:[]}),a[n].items.push({item_name:e[t].item_name,item_price:e[t].item_price})})),n.setState((function(e){return t?Object(T.a)(Object(T.a)({},e),{},{data:a,selected:t}):Object(T.a)(Object(T.a)({},e),{},{data:a,selected:""})}))},n.setMessage=function(e){return"success"===e?n.setState({success:!0}):"error"===e?n.setState({success:!1}):void n.setState({success:null})},n.setModal=function(e){return n.state.data[e]||""===e?n.setState({selected:e}):n.getAll(e)},n.getAll=n.getAll.bind(Object(o.a)(n)),n.createDataObject=n.createDataObject.bind(Object(o.a)(n)),n.setMessage=n.setMessage.bind(Object(o.a)(n)),n.setModal=n.setModal.bind(Object(o.a)(n)),n.state={currentUser:M.getUser(),data:null,update:!1,success:null,selected:""},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getAll()}},{key:"render",value:function(){var e=this;return null==this.state.data?Object(p.jsxs)("div",{class:"ui container",children:[Object(p.jsx)(N,{}),Object(p.jsx)("h1",{children:" Current Receipts "})]}):Object(p.jsxs)("div",{class:"ui container",children:[Object(p.jsx)(N,{}),Object(p.jsx)("h1",{children:" Current Receipts "}),Object(p.jsx)(ce,{setModal:this.setModal}),!0===this.state.success?Object(p.jsx)(le,{}):null,!1===this.state.success?Object(p.jsx)(y,{}):null,Object(p.jsx)(_.a,{padded:!0,children:Object(p.jsx)(Z.a.Group,{children:Object.keys(this.state.data).map((function(t){return Object(p.jsx)(ne,{getAll:e.getAll,data:e.state.data[t],setMessage:e.setMessage,modalOn:e.state.selected,clearModal:e.setModal},t)}))})})]})}}]),a}(s.a.Component),de=function(){return Object(p.jsx)(O.a,{success:!0,header:"Congratulations! You're registered.",content:"You may log in."})},he=function(e){var t=e.success;return!0===t?Object(p.jsx)(de,{}):!1===t?Object(p.jsx)(m,{}):null},je=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onChangeEmail=function(e){n.setState({email:e.target.value})},n.onChangePassword=function(e){n.setState({password:e.target.value})},n.getSubmit=function(e){var t={email:n.state.email,password:n.state.password};b.a.post("/users",t).then((function(e){console.log(e),"taken"==e.data.message?n.setState({success:!1}):n.setState({success:!0})})).catch((function(e){n.setState({success:!1})}))},n.onChangeEmail=n.onChangeEmail.bind(Object(o.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(o.a)(n)),n.state={email:"",password:"",loading:!1,success:null},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsxs)(A.a,{fluid:!0,children:[Object(p.jsx)(he,{success:this.state.success}),Object(p.jsx)(E.a,{onSubmit:this.getSubmit,children:Object(p.jsxs)(_.a,{children:[Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"Email"}),Object(p.jsx)("input",{onChange:this.onChangeEmail,value:this.state.email,type:"email",id:"email",name:"email"})]}),Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"Password"}),Object(p.jsx)("input",{type:"password",id:"password",name:"password",value:this.state.password,onChange:this.onChangePassword})]}),Object(p.jsx)(D.a,{color:"green",type:"submit",primary:!0,children:"Submit"})]})})]})}}]),a}(s.a.Component),ue=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(p.jsxs)(_.a,{compact:!0,children:[Object(p.jsx)(_.a,{basic:!0,children:Object(p.jsx)(D.a,{floated:"right",onClick:function(){e.props.history.push("/")},children:"Back"})}),Object(p.jsx)(_.a,{basic:!0,children:Object(p.jsx)(je,{})})]})}}]),a}(s.a.Component),be=ue,Oe=a(127),pe=["component"],me=function(e){var t=e.component,a=Object(Oe.a)(e,pe);return Object(p.jsx)(j.b,Object(T.a)(Object(T.a)({},a),{},{render:function(e){return!0===M.isAuth()?Object(p.jsx)(t,Object(T.a)({},e)):Object(p.jsx)(j.a,{to:{pathname:"/",state:{from:e.location}}})}}))},xe=["component"],fe=function(e){var t=e.component,a=Object(Oe.a)(e,xe);return Object(p.jsx)(j.b,Object(T.a)(Object(T.a)({},a),{},{render:function(e){return!0===M.isAuth()?Object(p.jsx)(j.a,{to:{pathname:"/upload",state:{from:e.location}}}):Object(p.jsx)(t,Object(T.a)({},e))}}))},ge=a(228),Ce=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){if(e.preventDefault(),n.state.new!==n.state.confirm)return n.setState({error:"confirm"});var t={old_password:n.state.old,new_password:n.state.new};b.a.patch("/users/".concat(n.user_id),t,{withCredentials:!0}).then((function(e){if("password-no-match"===e.data.message)return n.setState({error:"old"});n.props.cancel("password")})).catch((function(e){n.props.handleError("passChange")}))},n.handleInput=function(e){var t=e.target.id;"old"===t&&n.setState({old:e.target.value}),"new"===t&&n.setState({new:e.target.value}),"confirm"===t&&n.setState({confirm:e.target.value})},n.state={new:"",confirm:"",old:"",error:null,success:!1},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsx)("div",{children:Object(p.jsxs)(E.a,{onSubmit:this.handleSubmit,children:[Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"old password"}),Object(p.jsx)("input",{id:"old",type:"password",placeholder:"old password",onChange:this.handleInput}),"old"===this.state.error?Object(p.jsx)(w,{}):null]}),Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"new password"}),Object(p.jsx)("input",{id:"new",type:"password",placeholder:"new password",onChange:this.handleInput})]}),Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"confirm new password"}),Object(p.jsx)("input",{id:"confirm",type:"password",placeholder:"confirm password",onChange:this.handleInput}),"confirm"===this.state.error?Object(p.jsx)(v,{}):null]}),Object(p.jsx)(D.a,{type:"submit",children:"Submit"}),Object(p.jsx)(D.a,{onClick:this.props.cancel,children:"Cancel"})]})})}}]),a}(s.a.Component),ve=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleClick=function(){n.setState({button:!1,success:""})},n.handleCancel=function(e){"password"===e&&n.setState({button:!0,success:"password"}),n.setState({button:!0})},n.handleCancel=n.handleCancel.bind(Object(o.a)(n)),n.handleClick=n.handleClick.bind(Object(o.a)(n)),n.state={button:!0,success:""},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{children:[this.state.button?Object(p.jsx)(ge.a.Header,{onClick:this.handleClick,children:"Change Password"}):Object(p.jsx)(Ce,{cancel:this.handleCancel,handleError:this.props.handleError}),"password"===this.state.success?Object(p.jsx)(ie,{}):null]})})}}]),a}(s.a.Component),we=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){if(e.preventDefault(),n.state.new!==n.state.confirm)return n.setState({error:"confirm"});var t={email:n.state.new};b.a.patch("/users/".concat(n.user_id),t,{withCredentials:!0}).then((function(e){if("email-in-use"===e.data.message)return n.setState({error:"in-use"});n.props.cancel("email")})).catch((function(e){n.props.handleError("emailChange")}))},n.handleInput=function(e){var t=e.target.id;"new"===t&&n.setState({new:e.target.value}),"confirm"===t&&n.setState({confirm:e.target.value})},n.state={new:"",confirm:"",error:null,success:!1},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsx)("div",{children:Object(p.jsxs)(E.a,{onSubmit:this.handleSubmit,children:[Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"new email"}),Object(p.jsx)("input",{id:"new",type:"email",placeholder:"new email",onChange:this.handleInput}),"in-use"===this.state.error?Object(p.jsx)(S,{}):null]}),Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"confirm new email"}),Object(p.jsx)("input",{id:"confirm",type:"email",placeholder:"confirm email",onChange:this.handleInput}),"confirm"===this.state.error?Object(p.jsx)(k,{}):null]}),Object(p.jsx)(D.a,{type:"submit",children:"Submit"}),Object(p.jsx)(D.a,{onClick:this.props.cancel,children:"Cancel"})]})})}}]),a}(s.a.Component),ke=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleClick=function(){n.setState({button:!1,success:""})},n.handleCancel=function(e){"email"===e&&n.setState({button:!0,success:"email"}),n.setState({button:!0})},n.handleCancel=n.handleCancel.bind(Object(o.a)(n)),n.handleClick=n.handleClick.bind(Object(o.a)(n)),n.state={button:!0,success:""},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{children:[this.state.button?Object(p.jsx)(ge.a.Header,{onClick:this.handleClick,children:"Change Email"}):Object(p.jsx)(we,{cancel:this.handleCancel,handleError:this.props.handleError}),"email"===this.state.success?Object(p.jsx)(re,{}):null]})})}}]),a}(s.a.Component),Se=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){if(e.preventDefault(),n.state.user!==n.state.confirm)return n.setState({error:"confirm"});var t={email:n.state.user};b.a.delete("/users/".concat(n.user_id),t,{withCredentials:!0}).then((function(e){M.logout((function(){n.props.history.push("/")}))})).catch((function(e){return n.props.handleError("delete")}))},n.handleInput=function(e){"confirm"===e.target.id&&n.setState({confirm:e.target.value})},n.state={user:M.getUser(),confirm:"",error:null},n.user_id=M.user_id,n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsx)("div",{children:Object(p.jsxs)(E.a,{onSubmit:this.handleSubmit,children:[Object(p.jsxs)(E.a.Field,{children:[Object(p.jsx)("label",{children:"Account will be deleted after email is confirmed"}),Object(p.jsx)("input",{id:"confirm",type:"email",placeholder:"confirm email",onChange:this.handleInput}),"confirm"===this.state.error?Object(p.jsx)(k,{}):null]}),Object(p.jsx)(D.a,{type:"submit",children:"Submit"}),Object(p.jsx)(D.a,{onClick:this.props.cancel,children:"Cancel"})]})})}}]),a}(s.a.Component),ye=Object(j.g)(Se),_e=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleClick=function(){n.setState({button:!1,success:""})},n.handleCancel=function(){n.setState({button:!0})},n.handleCancel=n.handleCancel.bind(Object(o.a)(n)),n.handleClick=n.handleClick.bind(Object(o.a)(n)),n.state={button:!0,error:null},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsx)("div",{children:Object(p.jsx)("div",{children:this.state.button?Object(p.jsx)(ge.a.Header,{onClick:this.handleClick,children:"Delete Account"}):Object(p.jsx)(ye,{cancel:this.handleCancel,handleError:this.props.handleError})})})}}]),a}(s.a.Component),Ee=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleError=function(e){return n.setState({error:e})},n.handleError=n.handleError.bind(Object(o.a)(n)),n.state={user:M.getUser(),error:null},n}return Object(l.a)(a,[{key:"render",value:function(){return Object(p.jsxs)(A.a,{children:[Object(p.jsx)(N,{}),Object(p.jsxs)("h1",{children:["Welcome, ",this.state.user]}),Object(p.jsxs)(_.a,{basic:!0,children:["delete"===this.state.error?Object(p.jsx)(x,{}):null,"emailChange"===this.state.error?Object(p.jsx)(f,{}):null,"passChange"===this.state.error?Object(p.jsx)(g,{}):null]}),Object(p.jsxs)(ge.a,{animated:!0,verticalAlign:"middle",children:[Object(p.jsxs)(ge.a.Item,{children:[Object(p.jsx)(B.a,{name:"edit"}),Object(p.jsx)(ge.a.Content,{children:Object(p.jsx)(ve,{handleError:this.handleError})})]}),Object(p.jsxs)(ge.a.Item,{children:[Object(p.jsx)(B.a,{name:"edit"}),Object(p.jsx)(ge.a.Content,{children:Object(p.jsx)(ke,{handleError:this.handleError})})]}),Object(p.jsxs)(ge.a.Item,{children:[Object(p.jsx)(B.a,{name:"trash alternate outline",color:"red"}),Object(p.jsx)(ge.a.Content,{children:Object(p.jsx)(_e,{handleError:this.handleError})})]})]})]})}}]),a}(s.a.Component),De=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).setUser=function(){n.setState({user:M.getUser()})},n.setUser=n.setUser.bind(Object(o.a)(n)),n.state={user:M.getUser(),jwt:null},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){this.setState({user:M.getUser()}),this.setState({jwt:M.getToken()})}},{key:"render",value:function(){return Object(p.jsxs)(j.d,{children:[Object(p.jsx)(fe,{path:"/",exact:!0,component:L}),Object(p.jsx)(me,{path:"/account",exact:!0,component:Ee}),Object(p.jsx)(me,{path:"/upload",exact:!0,component:Q}),Object(p.jsx)(me,{path:"/receipts",exact:!0,component:oe}),Object(p.jsx)(fe,{path:"/register",exact:!0,component:be})]})}}]),a}(s.a.Component);a(202),a(203);i.a.render(Object(p.jsx)(V.a,{children:Object(p.jsx)(De,{})}),document.getElementById("root"))}},[[204,1,2]]]);
//# sourceMappingURL=main.cf8eea17.chunk.js.map